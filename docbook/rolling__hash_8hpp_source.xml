<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_rolling__hash_8hpp_source" xml:lang="ja">
<title>rolling_hash.hpp</title>
<indexterm><primary>string/rolling_hash.hpp</primary></indexterm>
[詳解]<programlisting linenumbering="unnumbered"><anchor xml:id="_rolling__hash_8hpp_source_1l00001"/>00001 <emphasis role="preprocessor">#</emphasis><emphasis role="preprocessor">include</emphasis><emphasis role="preprocessor">&quot;../../kyopro_library/template.hpp&quot;</emphasis>
<anchor xml:id="_rolling__hash_8hpp_source_1l00002"/>00002 <emphasis role="preprocessor">#</emphasis><emphasis role="preprocessor">include</emphasis><emphasis role="preprocessor">&quot;../../kyopro_library/others/xor128.hpp&quot;</emphasis>
<anchor xml:id="_rolling__hash_8hpp_source_1l00003"/>00003 <emphasis role="preprocessor">#</emphasis><emphasis role="preprocessor">include</emphasis><emphasis role="preprocessor">&quot;../../kyopro_library/others/modcal.hpp&quot;</emphasis>
<anchor xml:id="_rolling__hash_8hpp_source_1l00004"/>00004 
<anchor xml:id="_rolling__hash_8hpp_source_1l00005"/>00005 <emphasis role="comment">///&#32;@attention&#32;問題の成約に合わせて書き換えること</emphasis>
<anchor xml:id="_rolling__hash_8hpp_source_1l00006"/>00006 <emphasis role="comment">//&#32;constexpr&#32;const&#32;int&#32;HASH_MAX=1000000;&#32;///&lt;&#32;長さの最大値</emphasis>
<anchor xml:id="_rolling__hash_8hpp_source_1l00007"/>00007 <emphasis role="comment">//&#32;constexpr&#32;const&#32;int&#32;HASH_C=256;&#32;///&lt;&#32;文字の範囲</emphasis>
<anchor xml:id="_rolling__hash_8hpp_source_1l00008"/>00008 <emphasis role="comment">//&#32;constexpr&#32;const&#32;int&#32;HASH_PRIME=3;&#32;///&lt;&#32;使う素数の個数</emphasis>
<anchor xml:id="_rolling__hash_8hpp_source_1l00009"/>00009 
<anchor xml:id="_rolling__hash_8hpp_source_1l00010"/><link linkend="_struct_hash">00010</link> <emphasis role="keyword">struct</emphasis>&#32;<link linkend="_struct_hash">Hash</link>&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00011"/>00011 
<anchor xml:id="_rolling__hash_8hpp_source_1l00012"/><link linkend="_struct_hash_1a093390f17c113dc150020dac86c6ddd4">00012</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">using</emphasis>&#32;<link linkend="_struct_hash">Type</link>=<link linkend="_struct_hash">array</link>&lt;<link linkend="_struct_hash">ll</link>,<link linkend="_struct_hash">HASH_PRIME</link>&gt;;
<anchor xml:id="_rolling__hash_8hpp_source_1l00013"/><link linkend="_struct_hash_1add9e6e3f9a1816111f3d1b03c1174d49">00013</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_hash_1add9e6e3f9a1816111f3d1b03c1174d49">VL</link>&#32;<link linkend="_struct_hash_1add9e6e3f9a1816111f3d1b03c1174d49">base</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00014"/><link linkend="_struct_hash_1a65e9a611ad519be5e54523e2845422dc">00014</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_hash_1a65e9a611ad519be5e54523e2845422dc">VVL</link>&#32;<link linkend="_struct_hash_1a65e9a611ad519be5e54523e2845422dc">inv</link>,<link linkend="_struct_hash_1a40b806f7e170c9454766807a0340696b">pow</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00015"/>00015 &#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keyword">const</emphasis>&#32;<link linkend="_struct_hash_1a3bd24b140ac1c70ae98a01974b0c9980">VL</link>&#32;<link linkend="_struct_hash_1a3bd24b140ac1c70ae98a01974b0c9980">mod</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00016"/><link linkend="_struct_hash_1a07623ca4117730eb67bce9817f146810">00016</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_struct_hash_1a07623ca4117730eb67bce9817f146810">flag</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00017"/>00017 &#32;&#32;&#32;&#32;<emphasis role="keyword">static</emphasis>&#32;<link linkend="_struct_hash_1afec174db8743f3050d2f39baef2a0e51">array</link>&lt;<link linkend="_struct_hash_1afec174db8743f3050d2f39baef2a0e51">array</link>&lt;<link linkend="_struct_hash_1afec174db8743f3050d2f39baef2a0e51">ll</link>,<link linkend="_struct_hash_1afec174db8743f3050d2f39baef2a0e51">HASH_PRIME</link>&gt;,256&gt;&#32;<link linkend="_struct_hash_1afec174db8743f3050d2f39baef2a0e51">num</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00018"/>00018 
<anchor xml:id="_rolling__hash_8hpp_source_1l00019"/><link linkend="_struct_hash_1a6a39c22a994feb6e341c48e1a9ac24cb">00019</link> &#32;&#32;&#32;&#32;<link linkend="_struct_hash_1a6a39c22a994feb6e341c48e1a9ac24cb">Type</link>&#32;<link linkend="_struct_hash_1a6a39c22a994feb6e341c48e1a9ac24cb">value</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00020"/>00020 
<anchor xml:id="_rolling__hash_8hpp_source_1l00021"/><link linkend="_struct_hash_1a525ce897ce585256fd241baf51c165b9">00021</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_struct_hash_1a525ce897ce585256fd241baf51c165b9">init</link>()&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00022"/>00022 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(<link linkend="_struct_hash_1a07623ca4117730eb67bce9817f146810">flag</link>)&#32;<emphasis role="keywordflow">return</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00023"/>00023 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_struct_hash_1a07623ca4117730eb67bce9817f146810">flag</link>=<emphasis role="keyword">true</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00024"/>00024 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;base=VL(HASH_PRIME);&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(i,HASH_PRIME)&#32;base[i]=Xor128(3000,mod[i]);
<anchor xml:id="_rolling__hash_8hpp_source_1l00025"/>00025 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;inv=VVL(HASH_PRIME);&#32;pow=VVL(HASH_PRIME);
<anchor xml:id="_rolling__hash_8hpp_source_1l00026"/>00026 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(i,HASH_PRIME)&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00027"/>00027 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;pow[i]=VL(HASH_MAX+1);&#32;inv[i]=VL(HASH_MAX+1);
<anchor xml:id="_rolling__hash_8hpp_source_1l00028"/>00028 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;pow[i][0]=1;&#32;inv[i][HASH_MAX]=ModInv(ModPow&lt;ll&gt;(base[i],HASH_MAX,mod[i]),mod[i]);
<anchor xml:id="_rolling__hash_8hpp_source_1l00029"/>00029 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(j,HASH_MAX)&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00030"/>00030 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;pow[i][j+1]=(pow[i][j]*base[i])%mod[i];
<anchor xml:id="_rolling__hash_8hpp_source_1l00031"/>00031 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;inv[i][HASH_MAX-j-1]=(inv[i][HASH_MAX-j]*base[i])%mod[i];
<anchor xml:id="_rolling__hash_8hpp_source_1l00032"/>00032 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00033"/>00033 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00034"/>00034 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(i,HASH_C)&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(j,HASH_PRIME)&#32;num[i][j]=<link linkend="_xor128_8hpp_1a1769a3e4e9794ae293252dc65f5c2425">Xor128</link><link linkend="_xor128_8hpp_1a1769a3e4e9794ae293252dc65f5c2425">(</link>1<link linkend="_xor128_8hpp_1a1769a3e4e9794ae293252dc65f5c2425">,</link>3000<link linkend="_xor128_8hpp_1a1769a3e4e9794ae293252dc65f5c2425">)</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00035"/>00035 &#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00036"/>00036 
<anchor xml:id="_rolling__hash_8hpp_source_1l00037"/><link linkend="_struct_hash_1a2bb49844b818de3146548f868777e87b">00037</link> &#32;&#32;&#32;&#32;<link linkend="_struct_hash_1a2bb49844b818de3146548f868777e87b">Hash</link>()=<emphasis role="keywordflow">default</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00038"/><link linkend="_struct_hash_1a0dabddca4882b6869a7cd3d130e9aad2">00038</link> &#32;&#32;&#32;&#32;<link linkend="_struct_hash_1a0dabddca4882b6869a7cd3d130e9aad2">Hash</link>(<emphasis role="keyword">const</emphasis>&#32;<link linkend="_struct_hash">Hash</link>&amp;&#32;other)&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00039"/>00039 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(!<link linkend="_struct_hash_1a07623ca4117730eb67bce9817f146810">flag</link>)&#32;<link linkend="_struct_hash_1a525ce897ce585256fd241baf51c165b9">init</link><link linkend="_struct_hash_1a525ce897ce585256fd241baf51c165b9">(</link><link linkend="_struct_hash_1a525ce897ce585256fd241baf51c165b9">)</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00040"/>00040 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;value=other.value;
<anchor xml:id="_rolling__hash_8hpp_source_1l00041"/>00041 &#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00042"/><link linkend="_struct_hash_1aa2704fbc0e9be14105f061e71b8c144a">00042</link> &#32;&#32;&#32;&#32;<link linkend="_struct_hash_1aa2704fbc0e9be14105f061e71b8c144a">Hash</link>(<emphasis role="keywordtype">char</emphasis>&#32;c)&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00043"/>00043 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(!<link linkend="_struct_hash_1a07623ca4117730eb67bce9817f146810">flag</link>)&#32;<link linkend="_struct_hash_1a525ce897ce585256fd241baf51c165b9">init</link><link linkend="_struct_hash_1a525ce897ce585256fd241baf51c165b9">(</link><link linkend="_struct_hash_1a525ce897ce585256fd241baf51c165b9">)</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00044"/>00044 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;value.fill(0);
<anchor xml:id="_rolling__hash_8hpp_source_1l00045"/>00045 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(i,HASH_PRIME)&#32;value[i]=num[c][i];
<anchor xml:id="_rolling__hash_8hpp_source_1l00046"/>00046 &#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00047"/>00047 
<anchor xml:id="_rolling__hash_8hpp_source_1l00048"/><link linkend="_struct_hash_1ad788fc103417e8d81d2c140bb05c1447">00048</link> &#32;&#32;&#32;&#32;<link linkend="_struct_hash">Hash</link>&amp;&#32;<link linkend="_struct_hash_1ad788fc103417e8d81d2c140bb05c1447">operator</link>+=(<emphasis role="keyword">const</emphasis>&#32;<link linkend="_struct_hash">Hash</link>&amp;&#32;other)&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00049"/>00049 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(i,HASH_PRIME)&#32;value[i]=(value[i]+other.value[i])%mod[i];
<anchor xml:id="_rolling__hash_8hpp_source_1l00050"/>00050 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;*<emphasis role="keyword">this</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00051"/>00051 &#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00052"/><link linkend="_struct_hash_1ae8b7b557d9b0fdbd7709be1bfc4ca9f5">00052</link> &#32;&#32;&#32;&#32;<link linkend="_struct_hash">Hash</link>&amp;&#32;<link linkend="_struct_hash_1ae8b7b557d9b0fdbd7709be1bfc4ca9f5">operator</link>-=(<emphasis role="keyword">const</emphasis>&#32;<link linkend="_struct_hash">Hash</link>&amp;&#32;other)&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00053"/>00053 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(i,HASH_PRIME)&#32;value[i]=(value[i]-other.value[i]+mod[i])%mod[i];
<anchor xml:id="_rolling__hash_8hpp_source_1l00054"/>00054 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;*<emphasis role="keyword">this</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00055"/>00055 &#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00056"/><link linkend="_struct_hash_1a37354fe2736bdaca531b94e17c44b784">00056</link> &#32;&#32;&#32;&#32;<link linkend="_struct_hash">Hash</link>&#32;<link linkend="_struct_hash_1a37354fe2736bdaca531b94e17c44b784">operator</link>+(<emphasis role="keyword">const</emphasis>&#32;<link linkend="_struct_hash">Hash</link>&amp;&#32;other)&#32;<emphasis role="keyword">const</emphasis>&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00057"/>00057 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_struct_hash">Hash</link>&#32;ret=*<emphasis role="keyword">this</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00058"/>00058 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ret<link linkend="_struct_hash_1ad788fc103417e8d81d2c140bb05c1447">+=</link>other;
<anchor xml:id="_rolling__hash_8hpp_source_1l00059"/>00059 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;ret;
<anchor xml:id="_rolling__hash_8hpp_source_1l00060"/>00060 &#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00061"/><link linkend="_struct_hash_1a6c2d1e0f276c921cfc4e46b001100c06">00061</link> &#32;&#32;&#32;&#32;<link linkend="_struct_hash">Hash</link>&#32;<link linkend="_struct_hash_1a6c2d1e0f276c921cfc4e46b001100c06">operator</link>-(<emphasis role="keyword">const</emphasis>&#32;<link linkend="_struct_hash">Hash</link>&amp;&#32;other)&#32;<emphasis role="keyword">const</emphasis>&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00062"/>00062 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_struct_hash">Hash</link>&#32;ret=*<emphasis role="keyword">this</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00063"/>00063 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ret<link linkend="_struct_hash_1ae8b7b557d9b0fdbd7709be1bfc4ca9f5">-=</link>other;
<anchor xml:id="_rolling__hash_8hpp_source_1l00064"/>00064 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;ret;
<anchor xml:id="_rolling__hash_8hpp_source_1l00065"/>00065 &#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00066"/><link linkend="_struct_hash_1ad96321a44bb502422139b5c06f484be3">00066</link> &#32;&#32;&#32;&#32;<link linkend="_struct_hash">Hash</link>&#32;<link linkend="_struct_hash_1ad96321a44bb502422139b5c06f484be3">shift</link>(<emphasis role="keywordtype">int</emphasis>&#32;x)&#32;<emphasis role="keyword">const</emphasis>&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00067"/>00067 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_struct_hash">Hash</link>&#32;ret=*<emphasis role="keyword">this</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00068"/>00068 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>(x&lt;0)&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(i,HASH_PRIME)&#32;(ret.value[i]*=inv[i][-x])%=mod[i];
<anchor xml:id="_rolling__hash_8hpp_source_1l00069"/>00069 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(i,HASH_PRIME)&#32;(ret.value[i]*=pow[i][x])%=mod[i];
<anchor xml:id="_rolling__hash_8hpp_source_1l00070"/>00070 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;ret;
<anchor xml:id="_rolling__hash_8hpp_source_1l00071"/>00071 &#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00072"/><link linkend="_struct_hash_1a06b1d032944f2169544b27ddedfe9abc">00072</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_struct_hash_1a06b1d032944f2169544b27ddedfe9abc">operator</link>==(<emphasis role="keyword">const</emphasis>&#32;<link linkend="_struct_hash">Hash</link>&amp;&#32;other)&#32;<emphasis role="keyword">const</emphasis>&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00073"/>00073 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(i,HASH_PRIME)&#32;<emphasis role="keywordflow">if</emphasis>(value[i]!=other.value[i])&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00074"/>00074 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keyword">true</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00075"/>00075 &#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00076"/><link linkend="_struct_hash_1af4e61589fbc15d41e10e54abecb77d9c">00076</link> &#32;&#32;&#32;&#32;<link linkend="_struct_hash">Hash</link>&amp;&#32;<link linkend="_struct_hash_1af4e61589fbc15d41e10e54abecb77d9c">operator</link>=(<emphasis role="keyword">const</emphasis>&#32;<link linkend="_struct_hash">Hash</link>&amp;&#32;other)&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00077"/>00077 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(i,HASH_PRIME)&#32;value[i]=other.value[i];
<anchor xml:id="_rolling__hash_8hpp_source_1l00078"/>00078 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;*<emphasis role="keyword">this</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00079"/>00079 &#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00080"/>00080 };
<anchor xml:id="_rolling__hash_8hpp_source_1l00081"/>00081 
<anchor xml:id="_rolling__hash_8hpp_source_1l00082"/>00082 <link linkend="_struct_hash_1add9e6e3f9a1816111f3d1b03c1174d49">VL</link>&#32;<link linkend="_struct_hash">Hash</link>::<link linkend="_struct_hash_1add9e6e3f9a1816111f3d1b03c1174d49">base</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00083"/>00083 <link linkend="_struct_hash_1a65e9a611ad519be5e54523e2845422dc">VVL</link>&#32;<link linkend="_struct_hash">Hash</link>::<link linkend="_struct_hash_1a65e9a611ad519be5e54523e2845422dc">inv</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00084"/>00084 <link linkend="_struct_hash_1a40b806f7e170c9454766807a0340696b">VVL</link>&#32;<link linkend="_struct_hash">Hash</link>::<link linkend="_struct_hash_1a40b806f7e170c9454766807a0340696b">pow</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00085"/><link linkend="_struct_hash_1a3bd24b140ac1c70ae98a01974b0c9980">00085</link> <emphasis role="keyword">const</emphasis>&#32;<link linkend="_struct_hash_1a3bd24b140ac1c70ae98a01974b0c9980">VL</link>&#32;<link linkend="_struct_hash">Hash</link>::<link linkend="_struct_hash_1a3bd24b140ac1c70ae98a01974b0c9980">mod</link>={1000000007,1000000009,1000000021,1000000033,1000000087};
<anchor xml:id="_rolling__hash_8hpp_source_1l00086"/>00086 <emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_struct_hash">Hash</link>::<link linkend="_struct_hash_1a07623ca4117730eb67bce9817f146810">flag</link>=<emphasis role="keyword">false</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00087"/><link linkend="_struct_hash_1afec174db8743f3050d2f39baef2a0e51">00087</link> <link linkend="_struct_hash_1afec174db8743f3050d2f39baef2a0e51">array</link>&lt;<link linkend="_struct_hash_1afec174db8743f3050d2f39baef2a0e51">array</link>&lt;<link linkend="_struct_hash_1afec174db8743f3050d2f39baef2a0e51">ll</link>,<link linkend="_struct_hash_1afec174db8743f3050d2f39baef2a0e51">HASH_PRIME</link>&gt;,<link linkend="_struct_hash_1afec174db8743f3050d2f39baef2a0e51">HASH_C</link>&gt;&#32;<link linkend="_struct_hash">Hash</link>::<link linkend="_struct_hash_1afec174db8743f3050d2f39baef2a0e51">num</link>={};
<anchor xml:id="_rolling__hash_8hpp_source_1l00088"/>00088 
<anchor xml:id="_rolling__hash_8hpp_source_1l00089"/>00089 
<anchor xml:id="_rolling__hash_8hpp_source_1l00090"/>00090 <emphasis role="comment">///@brief&#32;Rolling&#32;Hash</emphasis>
<anchor xml:id="_rolling__hash_8hpp_source_1l00091"/><link linkend="_struct_rolling_hash">00091</link> <emphasis role="keyword">struct</emphasis>&#32;<link linkend="_struct_rolling_hash">RollingHash</link>{
<anchor xml:id="_rolling__hash_8hpp_source_1l00092"/><link linkend="_struct_rolling_hash_1a71020424af6022b96f96117961ac4bc2">00092</link> &#32;&#32;&#32;&#32;<link linkend="_struct_rolling_hash_1a71020424af6022b96f96117961ac4bc2">RollingHash</link>()=<emphasis role="keywordflow">default</emphasis>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00093"/><link linkend="_struct_rolling_hash_1af6385ca8122334ec22fb8eb5819e320d">00093</link> &#32;&#32;&#32;&#32;<link linkend="_struct_rolling_hash_1af6385ca8122334ec22fb8eb5819e320d">vector</link>&lt;<link linkend="_struct_rolling_hash_1af6385ca8122334ec22fb8eb5819e320d">Hash</link>&gt;&#32;<link linkend="_struct_rolling_hash_1af6385ca8122334ec22fb8eb5819e320d">hash</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00094"/>00094 
<anchor xml:id="_rolling__hash_8hpp_source_1l00095"/>00095 &#32;&#32;&#32;&#32;<emphasis role="comment">///&#32;@brief&#32;文字列&#32;s&#32;の&#32;Rolling&#32;Hash&#32;を構築する</emphasis>
<anchor xml:id="_rolling__hash_8hpp_source_1l00096"/><link linkend="_struct_rolling_hash_1aee33123a728c1df6d8c0b3550baa0c43">00096</link> &#32;&#32;&#32;&#32;<link linkend="_struct_rolling_hash_1aee33123a728c1df6d8c0b3550baa0c43">RollingHash</link>(<emphasis role="keyword">const</emphasis>&#32;string&amp;&#32;s)&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00097"/>00097 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;n=s.size();
<anchor xml:id="_rolling__hash_8hpp_source_1l00098"/>00098 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;hash=vector&lt;Hash&gt;(n+1);
<anchor xml:id="_rolling__hash_8hpp_source_1l00099"/>00099 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_template_8hpp_1a17daffa35db12daabc89c90df168e706">REP</link>(i,n)&#32;hash[i+1]=hash[i]+Hash(s[i]).shift(i);
<anchor xml:id="_rolling__hash_8hpp_source_1l00100"/>00100 &#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00101"/>00101 
<anchor xml:id="_rolling__hash_8hpp_source_1l00102"/>00102 &#32;&#32;&#32;&#32;<emphasis role="comment">///&#32;@brief&#32;区間&#32;[l,&#32;r)&#32;のハッシュ値を取得する</emphasis>
<anchor xml:id="_rolling__hash_8hpp_source_1l00103"/><link linkend="_struct_rolling_hash_1a86240a7668f2836709c800ae2ba5e206">00103</link> &#32;&#32;&#32;&#32;<link linkend="_struct_hash">Hash</link>&#32;<link linkend="_struct_rolling_hash_1a86240a7668f2836709c800ae2ba5e206">get</link>(<emphasis role="keywordtype">int</emphasis>&#32;l,&#32;<emphasis role="keywordtype">int</emphasis>&#32;r)&#32;{
<anchor xml:id="_rolling__hash_8hpp_source_1l00104"/>00104 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_struct_hash">Hash</link>&#32;ret;
<anchor xml:id="_rolling__hash_8hpp_source_1l00105"/>00105 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ret=hash[r]-hash[l];
<anchor xml:id="_rolling__hash_8hpp_source_1l00106"/>00106 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ret<link linkend="_struct_hash_1af4e61589fbc15d41e10e54abecb77d9c">=</link>ret<link linkend="_struct_hash_1ad96321a44bb502422139b5c06f484be3">.</link><link linkend="_struct_hash_1ad96321a44bb502422139b5c06f484be3">shift</link><link linkend="_struct_hash_1ad96321a44bb502422139b5c06f484be3">(</link>-l<link linkend="_struct_hash_1ad96321a44bb502422139b5c06f484be3">)</link>;
<anchor xml:id="_rolling__hash_8hpp_source_1l00107"/>00107 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;ret;
<anchor xml:id="_rolling__hash_8hpp_source_1l00108"/>00108 &#32;&#32;&#32;&#32;}
<anchor xml:id="_rolling__hash_8hpp_source_1l00109"/>00109 };
</programlisting></section>
