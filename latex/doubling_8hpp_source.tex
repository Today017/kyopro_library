\doxysection{doubling.\+hpp}
\hypertarget{doubling_8hpp_source}{}\label{doubling_8hpp_source}\index{algorithm/doubling.hpp@{algorithm/doubling.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include"{}../../kyopro\_library/template.hpp"{}}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00005\ \textcolor{keyword}{template}<\textcolor{keywordtype}{int}\ Log>}
\DoxyCodeLine{00006\ \textcolor{keyword}{struct\ }Doubling\ \{}
\DoxyCodeLine{00007\ \ \ \ \ Doubling()=\textcolor{keywordflow}{default};}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00012\ \ \ \ \ \mbox{\hyperlink{struct_doubling_a3f383d5ff3d6047d5f7de54db42596de}{Doubling}}(\textcolor{keyword}{const}\ VI\&\ v)\ \{}
\DoxyCodeLine{00013\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ n=v.size();}
\DoxyCodeLine{00014\ \ \ \ \ \ \ \ \ nxt.assign(Log+1,VI(n));}
\DoxyCodeLine{00015\ \ \ \ \ \ \ \ \ REP(i,n)\ nxt[0][i]=v[i];}
\DoxyCodeLine{00016\ \ \ \ \ \ \ \ \ REP(i,n)\ nxt[0][i]=v[i];}
\DoxyCodeLine{00017\ \ \ \ \ \ \ \ \ REP(i,Log)\ REP(j,n)\ nxt[i+1][j]=nxt[i][nxt[i][j]];}
\DoxyCodeLine{00018\ \ \ \ \ \}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{struct_doubling_a0ba294fda4333aa6d26311da82eae634}{next}}(\textcolor{keywordtype}{int}\ start,\ ll\ k)\ \{}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ b=0;\ k>0;\ b++,k>>=1)\ \textcolor{keywordflow}{if}(k\&1)\ start=nxt[b][start];}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ start;}
\DoxyCodeLine{00025\ \ \ \ \ \}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00028\ \ \ \ \ VVI\ nxt;}
\DoxyCodeLine{00029\ \};}

\end{DoxyCode}
