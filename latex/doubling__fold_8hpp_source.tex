\doxysection{doubling\+\_\+fold.\+hpp}
\hypertarget{doubling__fold_8hpp_source}{}\label{doubling__fold_8hpp_source}\index{algorithm/doubling\_fold.hpp@{algorithm/doubling\_fold.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include"{}../../kyopro\_library/template.hpp"{}}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00006\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Mono\textcolor{keywordtype}{id},\ \textcolor{keywordtype}{int}\ Log>}
\DoxyCodeLine{00007\ \textcolor{keyword}{struct\ }DoublingFold\ \{}
\DoxyCodeLine{00008\ \ \ \ \ \textcolor{keyword}{using\ }Type=\textcolor{keyword}{typename}\ Monoid::Type;}
\DoxyCodeLine{00009\ \ \ \ \ DoublingFold()=\textcolor{keywordflow}{default};}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00015\ \ \ \ \ \mbox{\hyperlink{struct_doubling_fold_a7326be1879b679c77c45571fef4d4083}{DoublingFold}}(\textcolor{keyword}{const}\ VI\&\ p,\ \textcolor{keyword}{const}\ vector<Type>\&\ v)\ \{}
\DoxyCodeLine{00016\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ n=p.size();}
\DoxyCodeLine{00017\ \ \ \ \ \ \ \ \ dat.assign(Log+1,\ vector<Type>(n,Monoid::id()));}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ nxt.assign(Log+1,\ VI(n));}
\DoxyCodeLine{00019\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;\ i<n;\ i++)\ dat[0][i]=v[i],nxt[0][i]=p[i];}
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=1;\ i<=Log;\ i++)\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j=0;\ j<n;\ j++)\ \{}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \ \ \ \ nxt[i][j]=nxt[i-\/1][nxt[i-\/1][j]];}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \ \ \ \ dat[i][j]=Monoid::op(dat[i-\/1][j],\ dat[i-\/1][nxt[i-\/1][j]]);}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00024\ \ \ \ \ \}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00029\ \ \ \ \ Type\ \mbox{\hyperlink{struct_doubling_fold_a8351c3419c2041117f47e80436506010}{fold}}(\textcolor{keywordtype}{int}\ start,\ ll\ k)\ \{}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ Type\ ret=\ Monoid::id();}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ b=0;\ k>0;\ b++,k>>=1)\ \textcolor{keywordflow}{if}(k\&1)\ \{}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ ret=Monoid::op(ret,dat[b][start]);}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \ \ \ \ start=nxt[b][start];}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00036\ \ \ \ \ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{struct_doubling_fold_afd50a59ab1f2ab56d585b7896e444e65}{next}}(\textcolor{keywordtype}{int}\ start,\ ll\ k)\ \{}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ b=0;\ k>0;\ b++,k>>=1)\ \textcolor{keywordflow}{if}(k\&1)\ start=nxt[b][start];}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ start;}
\DoxyCodeLine{00043\ \ \ \ \ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00046\ \ \ \ \ vector<vector<Type>>\ dat;}
\DoxyCodeLine{00047\ \ \ \ \ VVI\ nxt;}
\DoxyCodeLine{00048\ \};}

\end{DoxyCode}
