\doxysection{scc.\+hpp}
\hypertarget{scc_8hpp_source}{}\label{scc_8hpp_source}\index{graph/scc.hpp@{graph/scc.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include"{}../../kyopro\_library/template.hpp"{}}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00005\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_scc_info}{SccInfo}}\ \{}
\DoxyCodeLine{00006\ \ \ \ \ VVI\ \mbox{\hyperlink{struct_scc_info_a6c60f29bbebf5f08925e7a324ea94fea}{members}};\ }
\DoxyCodeLine{00007\ \ \ \ \ VVI\ \mbox{\hyperlink{struct_scc_info_ac35e2812adadb0090e8005a282c73d38}{graph\_decomposed}};\ }
\DoxyCodeLine{00008\ \ \ \ \ VI\ \mbox{\hyperlink{struct_scc_info_a54a36f89682c3553e9269004a4affce1}{group}};\ }
\DoxyCodeLine{00009\ \};}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00014\ \mbox{\hyperlink{struct_scc_info}{SccInfo}}\ SccDecomposition(\textcolor{keyword}{const}\ VVI\&\ g)\ \{}
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{keywordtype}{int}\ n=g.size();}
\DoxyCodeLine{00016\ \ \ \ \ VVI\ g2(n);}
\DoxyCodeLine{00017\ \ \ \ \ REP(i,n)\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j:g[i])\ g2[j].push\_back(i);}
\DoxyCodeLine{00018\ \ \ \ \ VI\ order,component(n,-\/1),seen(n,\textcolor{keyword}{false});}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keyword}{auto}\ dfs=[\&](\textcolor{keyword}{auto}\ dfs,\ \textcolor{keywordtype}{int}\ now)-\/>\ \textcolor{keywordtype}{void}\ \{}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ seen[now]=\textcolor{keyword}{true};}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ nxt:g[now])\ \textcolor{keywordflow}{if}(!seen[nxt])\ dfs(dfs,nxt);}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ order.push\_back(now);}
\DoxyCodeLine{00024\ \ \ \ \ \};}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keyword}{auto}\ dfs2=[\&](\textcolor{keyword}{auto}\ dfs2,\ \textcolor{keywordtype}{int}\ now,\ \textcolor{keywordtype}{int}\ idx)-\/>\ \textcolor{keywordtype}{void}\ \{}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ component[now]=idx;}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ nxt:g2[now])\ \textcolor{keywordflow}{if}(component[nxt]==-\/1)\ dfs2(dfs2,nxt,idx);}
\DoxyCodeLine{00029\ \ \ \ \ \};}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \ \ REP(i,n)\ \textcolor{keywordflow}{if}(!seen[i])\ dfs(dfs,i);}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ reverse(ALL(order));}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{int}\ idx=0;}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ now:order)\ \textcolor{keywordflow}{if}(component[now]==-\/1)\ dfs2(dfs2,now,idx),idx++;}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordtype}{int}\ n\_n=*max\_element(ALL(component))+1;}
\DoxyCodeLine{00038\ \ \ \ \ VVI\ ret(n\_n),ret2(n\_n);}
\DoxyCodeLine{00039\ \ \ \ \ REP(i,n)\ ret[component[i]].push\_back(i);}
\DoxyCodeLine{00040\ \ \ \ \ REP(i,n)\ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j:g[i])\ \textcolor{keywordflow}{if}(component[i]!=component[j])\ ret2[component[i]].push\_back(component[j]);}
\DoxyCodeLine{00041\ \ \ \ \ REP(i,n\_n)\ UQ(ret2[i]);}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordflow}{return}\ \{ret,ret2,component\};}
\DoxyCodeLine{00044\ \}}

\end{DoxyCode}
