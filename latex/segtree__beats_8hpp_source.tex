\doxysection{segtree\+\_\+beats.\+hpp}
\hypertarget{segtree__beats_8hpp_source}{}\label{segtree__beats_8hpp_source}\index{data\_structure/segtree\_beats.hpp@{data\_structure/segtree\_beats.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ "{}../../kyopro\_library/template.hpp"{}}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00005\ \textcolor{keyword}{struct\ }AngelBeats\ \{}
\DoxyCodeLine{00006\ \ \ \ \ \textcolor{keyword}{struct\ }\textcolor{keyword}{alignas}(32)\ \mbox{\hyperlink{struct_angel_beats_1_1_node}{Node}}\ \{}
\DoxyCodeLine{00007\ \ \ \ \ \ \ \ \ ll\ sum\ =\ 0,\ g1\ =\ 0,\ l1\ =\ 0;}
\DoxyCodeLine{00008\ \ \ \ \ \ \ \ \ ll\ g2\ =\ -\/INFL,\ gc\ =\ 1,\ l2\ =\ INFL,\ lc\ =\ 1,\ add\ =\ 0;}
\DoxyCodeLine{00009\ \ \ \ \ \};}
\DoxyCodeLine{00010\ \ \ \ \ vector<Node>\ v;}
\DoxyCodeLine{00011\ \ \ \ \ ll\ n,\ log;}
\DoxyCodeLine{00012\ \ \ \ \ AngelBeats()\ \{\}}
\DoxyCodeLine{00013\ \ \ \ \ \mbox{\hyperlink{struct_angel_beats}{AngelBeats}}(\textcolor{keywordtype}{int}\ \_n)\ :\ \mbox{\hyperlink{struct_angel_beats}{AngelBeats}}(vector<ll>(\_n))\ \{\}}
\DoxyCodeLine{00014\ \ \ \ \ AngelBeats(\textcolor{keyword}{const}\ vector<ll>\&\ vc)\ \{}
\DoxyCodeLine{00015\ \ \ \ \ \ \ \ \ n\ =\ 1,\ log\ =\ 0;}
\DoxyCodeLine{00016\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (n\ <\ (\textcolor{keywordtype}{int})vc.size())\ n\ <<=\ 1,\ log++;}
\DoxyCodeLine{00017\ \ \ \ \ \ \ \ \ v.resize(2\ *\ n);}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (ll\ i\ =\ 0;\ i\ <\ (int)vc.size();\ ++i)\ \{}
\DoxyCodeLine{00019\ \ \ \ \ \ \ \ \ \ \ \ \ v[i\ +\ n].sum\ =\ v[i\ +\ n].g1\ =\ v[i\ +\ n].l1\ =\ vc[i];}
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (ll\ i\ =\ n\ -\/\ 1;\ i;\ -\/-\/i)\ update(i);}
\DoxyCodeLine{00022\ \ \ \ \ \}}
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{struct_angel_beats_a67c2e44c754b5dd0673b2030b4030e85}{range\_chmin}}(\textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{int}\ r,\ ll\ x)\ \{\ inner\_apply<1>(l,\ r,\ x);\ \}}
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{struct_angel_beats_ac9b00c11a8c9d6233ad0a4c82517c738}{range\_chmax}}(\textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{int}\ r,\ ll\ x)\ \{\ inner\_apply<2>(l,\ r,\ x);\ \}}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{struct_angel_beats_aa15c52a208f93f199177ba9dcd4075ad}{range\_add}}(\textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{int}\ r,\ ll\ x)\ \{\ inner\_apply<3>(l,\ r,\ x);\ \}}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{struct_angel_beats_a000ae625539fb25bd1fa22407a78893d}{range\_update}}(\textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{int}\ r,\ ll\ x)\ \{\ inner\_apply<4>(l,\ r,\ x);\ \}}
\DoxyCodeLine{00032\ \ \ \ \ ll\ \mbox{\hyperlink{struct_angel_beats_a4fcefcfbe67f6b936d04c466517cc82f}{range\_min}}(\textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{int}\ r)\ \{\ \textcolor{keywordflow}{return}\ inner\_fold<1>(l,\ r);\ \}}
\DoxyCodeLine{00034\ \ \ \ \ ll\ \mbox{\hyperlink{struct_angel_beats_a697f138772500873140fbf1e220be15a}{range\_max}}(\textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{int}\ r)\ \{\ \textcolor{keywordflow}{return}\ inner\_fold<2>(l,\ r);\ \}}
\DoxyCodeLine{00036\ \ \ \ \ ll\ \mbox{\hyperlink{struct_angel_beats_a3ac7d0122289b20297f73e5bdb848f58}{range\_sum}}(\textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{int}\ r)\ \{\ \textcolor{keywordflow}{return}\ inner\_fold<3>(l,\ r);\ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{void}\ update(\textcolor{keywordtype}{int}\ k)\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ Node\&\ p\ =\ v[k];}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ Node\&\ l\ =\ v[k\ *\ 2\ +\ 0];}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ Node\&\ r\ =\ v[k\ *\ 2\ +\ 1];}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ p.sum\ =\ l.sum\ +\ r.sum;}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (l.g1\ ==\ r.g1)\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ p.g1\ =\ l.g1;}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ p.g2\ =\ max(l.g2,\ r.g2);}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ p.gc\ =\ l.gc\ +\ r.gc;}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ f\ =\ l.g1\ >\ r.g1;}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ p.g1\ =\ f\ ?\ l.g1\ :\ r.g1;}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ p.gc\ =\ f\ ?\ l.gc\ :\ r.gc;}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ p.g2\ =\ max(f\ ?\ r.g1\ :\ l.g1,\ f\ ?\ l.g2\ :\ r.g2);}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (l.l1\ ==\ r.l1)\ \{}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ p.l1\ =\ l.l1;}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ p.l2\ =\ min(l.l2,\ r.l2);}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ p.lc\ =\ l.lc\ +\ r.lc;}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ f\ =\ l.l1\ <\ r.l1;}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ p.l1\ =\ f\ ?\ l.l1\ :\ r.l1;}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ p.lc\ =\ f\ ?\ l.lc\ :\ r.lc;}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ p.l2\ =\ min(f\ ?\ r.l1\ :\ l.l1,\ f\ ?\ l.l2\ :\ r.l2);}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00064\ \ \ \ \ \}}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordtype}{void}\ push\_add(\textcolor{keywordtype}{int}\ k,\ ll\ x)\ \{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_angel_beats_1_1_node}{Node}}\&\ p\ =\ v[k];}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ p.sum\ +=\ x\ <<\ (log\ +\ \_\_builtin\_clz(k)\ -\/\ 31);}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ p.g1\ +=\ x;}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ p.l1\ +=\ x;}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.g2\ !=\ -\/INFL)\ p.g2\ +=\ x;}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.l2\ !=\ INFL)\ p.l2\ +=\ x;}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ p.add\ +=\ x;}
\DoxyCodeLine{00073\ \ \ \ \ \}}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordtype}{void}\ push\_min(\textcolor{keywordtype}{int}\ k,\ ll\ x)\ \{}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_angel_beats_1_1_node}{Node}}\&\ p\ =\ v[k];}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ p.sum\ +=\ (x\ -\/\ p.g1)\ *\ p.gc;}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.l1\ ==\ p.g1)\ p.l1\ =\ x;}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.l2\ ==\ p.g1)\ p.l2\ =\ x;}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ p.g1\ =\ x;}
\DoxyCodeLine{00080\ \ \ \ \ \}}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordtype}{void}\ push\_max(\textcolor{keywordtype}{int}\ k,\ ll\ x)\ \{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_angel_beats_1_1_node}{Node}}\&\ p\ =\ v[k];}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ p.sum\ +=\ (x\ -\/\ p.l1)\ *\ p.lc;}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.g1\ ==\ p.l1)\ p.g1\ =\ x;}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.g2\ ==\ p.l1)\ p.g2\ =\ x;}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ p.l1\ =\ x;}
\DoxyCodeLine{00087\ \ \ \ \ \}}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordtype}{void}\ push(\textcolor{keywordtype}{int}\ k)\ \{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_angel_beats_1_1_node}{Node}}\&\ p\ =\ v[k];}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.add\ !=\ 0)\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ push\_add(k\ *\ 2\ +\ 0,\ p.add);}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ push\_add(k\ *\ 2\ +\ 1,\ p.add);}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ p.add\ =\ 0;}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.g1\ <\ v[k\ *\ 2\ +\ 0].g1)\ push\_min(k\ *\ 2\ +\ 0,\ p.g1);}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.l1\ >\ v[k\ *\ 2\ +\ 0].l1)\ push\_max(k\ *\ 2\ +\ 0,\ p.l1);}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.g1\ <\ v[k\ *\ 2\ +\ 1].g1)\ push\_min(k\ *\ 2\ +\ 1,\ p.g1);}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p.l1\ >\ v[k\ *\ 2\ +\ 1].l1)\ push\_max(k\ *\ 2\ +\ 1,\ p.l1);}
\DoxyCodeLine{00099\ \ \ \ \ \}}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordtype}{void}\ subtree\_chmin(\textcolor{keywordtype}{int}\ k,\ ll\ x)\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (v[k].g1\ <=\ x)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (v[k].g2\ <\ x)\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ push\_min(k,\ x);}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ push(k);}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ subtree\_chmin(k\ *\ 2\ +\ 0,\ x);}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ subtree\_chmin(k\ *\ 2\ +\ 1,\ x);}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ update(k);}
\DoxyCodeLine{00110\ \ \ \ \ \}}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keywordtype}{void}\ subtree\_chmax(\textcolor{keywordtype}{int}\ k,\ ll\ x)\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ <=\ v[k].l1)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ <\ v[k].l2)\ \{}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ push\_max(k,\ x);}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ push(k);}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ subtree\_chmax(k\ *\ 2\ +\ 0,\ x);}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ subtree\_chmax(k\ *\ 2\ +\ 1,\ x);}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ update(k);}
\DoxyCodeLine{00121\ \ \ \ \ \}}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ cmd>}
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \_apply(\textcolor{keywordtype}{int}\ k,\ ll\ x)\ \{}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (cmd\ ==\ 1)\ subtree\_chmin(k,\ x);}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (cmd\ ==\ 2)\ subtree\_chmax(k,\ x);}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (cmd\ ==\ 3)\ push\_add(k,\ x);}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (cmd\ ==\ 4)\ subtree\_chmin(k,\ x),\ subtree\_chmax(k,\ x);}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ cmd>}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordtype}{void}\ inner\_apply(\textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{int}\ r,\ ll\ x)\ \{}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (l\ ==\ r)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ l\ +=\ n,\ r\ +=\ n;}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ log;\ i\ >=\ 1;\ i-\/-\/)\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (((l\ >>\ i)\ <<\ i)\ !=\ l)\ push(l\ >>\ i);}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (((r\ >>\ i)\ <<\ i)\ !=\ r)\ push((r\ -\/\ 1)\ >>\ i);}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ l2\ =\ l,\ r2\ =\ r;}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (l\ <\ r)\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (l\ \&\ 1)\ \_apply<cmd>(l++,\ x);}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ \&\ 1)\ \_apply<cmd>(-\/-\/r,\ x);}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ l\ >>=\ 1;}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ r\ >>=\ 1;}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ l\ =\ l2;}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ r\ =\ r2;}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <=\ log;\ i++)\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (((l\ >>\ i)\ <<\ i)\ !=\ l)\ update(l\ >>\ i);}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (((r\ >>\ i)\ <<\ i)\ !=\ r)\ update((r\ -\/\ 1)\ >>\ i);}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00152\ \ \ \ \ \}}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ cmd>}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keyword}{inline}\ ll\ e()\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (cmd\ ==\ 1)\ \textcolor{keywordflow}{return}\ INFL;}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (cmd\ ==\ 2)\ \textcolor{keywordflow}{return}\ -\/INFL;}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00158\ \ \ \ \ \}}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ cmd>}
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ op(ll\&\ a,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_angel_beats_1_1_node}{Node}}\&\ b)\ \{}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (cmd\ ==\ 1)\ a\ =\ min(a,\ b.l1);}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (cmd\ ==\ 2)\ a\ =\ max(a,\ b.g1);}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (cmd\ ==\ 3)\ a\ +=\ b.sum;}
\DoxyCodeLine{00164\ \ \ \ \ \}}
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\ cmd>}
\DoxyCodeLine{00166\ \ \ \ \ ll\ inner\_fold(\textcolor{keywordtype}{int}\ l,\ \textcolor{keywordtype}{int}\ r)\ \{}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (l\ ==\ r)\ \textcolor{keywordflow}{return}\ e<cmd>();}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ l\ +=\ n,\ r\ +=\ n;}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ log;\ i\ >=\ 1;\ i-\/-\/)\ \{}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (((l\ >>\ i)\ <<\ i)\ !=\ l)\ push(l\ >>\ i);}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (((r\ >>\ i)\ <<\ i)\ !=\ r)\ push((r\ -\/\ 1)\ >>\ i);}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ ll\ lx\ =\ e<cmd>(),\ rx\ =\ e<cmd>();}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (l\ <\ r)\ \{}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (l\ \&\ 1)\ op<cmd>(lx,\ v[l++]);}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ \&\ 1)\ op<cmd>(rx,\ v[-\/-\/r]);}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ l\ >>=\ 1;}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ r\ >>=\ 1;}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (cmd\ ==\ 1)\ lx\ =\ min(lx,\ rx);}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (cmd\ ==\ 2)\ lx\ =\ max(lx,\ rx);}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keyword}{constexpr}\ (cmd\ ==\ 3)\ lx\ +=\ rx;}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ lx;}
\DoxyCodeLine{00184\ \ \ \ \ \}}
\DoxyCodeLine{00185\ \};}

\end{DoxyCode}
