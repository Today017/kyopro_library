\doxysection{xor\+\_\+convolution.\+hpp}
\hypertarget{xor__convolution_8hpp_source}{}\label{xor__convolution_8hpp_source}\index{math/xor\_convolution.hpp@{math/xor\_convolution.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ "{}../../kyopro\_library/template.hpp"{}}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00004\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00005\ \textcolor{keywordtype}{void}\ FHT(vector<T>\&\ a,\ \textcolor{keywordtype}{bool}\ inv=\textcolor{keyword}{false})\ \{}
\DoxyCodeLine{00006\ \ \ \ \ \textcolor{keywordtype}{int}\ h=\_\_lg(a.size());}
\DoxyCodeLine{00007\ \ \ \ \ REP(i,h)\ REP(j,1<<h)\ \textcolor{keywordflow}{if}(\string~j>>i\&1)\ \{}
\DoxyCodeLine{00008\ \ \ \ \ \ \ \ \ T\ x=a[j],y=a[j|1<<i];}
\DoxyCodeLine{00009\ \ \ \ \ \ \ \ \ a[j]=x+y,a[j|1<<i]=x-\/y;}
\DoxyCodeLine{00010\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(inv)\ a[j]/=2,a[j|1<<i]/=2;}
\DoxyCodeLine{00011\ \ \ \ \ \}}
\DoxyCodeLine{00012\ \ \ \ \ \textcolor{keywordflow}{return}\ a;}
\DoxyCodeLine{00013\ \}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00019\ vector<T>\ XorConvolution(vector<T>\ a,\ vector<T>\ b)\ \{}
\DoxyCodeLine{00020\ \ \ \ \ FHT(a);\ FHT(b);}
\DoxyCodeLine{00021\ \ \ \ \ REP(i,a.size())\ a[i]*=b[i];}
\DoxyCodeLine{00022\ \ \ \ \ FHT(a,true);}
\DoxyCodeLine{00023\ \ \ \ \ return\ a;}
\DoxyCodeLine{00024\ \}}

\end{DoxyCode}
